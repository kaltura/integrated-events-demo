"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.KalturaRequest = void 0;
var tslib_1 = require("tslib");
var kaltura_response_1 = require("./kaltura-response");
var kaltura_request_base_1 = require("./kaltura-request-base");
var kaltura_api_exception_1 = require("./kaltura-api-exception");
var kaltura_request_options_1 = require("./kaltura-request-options");
var environment_1 = require("../environment");
var KalturaRequest = /** @class */ (function (_super) {
    tslib_1.__extends(KalturaRequest, _super);
    function KalturaRequest(data, _a) {
        var responseType = _a.responseType, responseSubType = _a.responseSubType, responseConstructor = _a.responseConstructor;
        var _this = _super.call(this, data) || this;
        _this.responseSubType = responseSubType;
        _this.responseType = responseType;
        _this._responseConstructor = responseConstructor;
        return _this;
    }
    KalturaRequest.prototype.setCompletion = function (callback) {
        this.callback = callback;
        return this;
    };
    KalturaRequest.prototype._unwrapResponse = function (response) {
        if (environment_1.environment.response.nestedResponse) {
            if (response && response.hasOwnProperty('result')) {
                if (response.result.hasOwnProperty('error')) {
                    return response.result.error;
                }
                else {
                    return response.result;
                }
            }
            else if (response && response.hasOwnProperty('error')) {
                return response.error;
            }
        }
        return response;
    };
    KalturaRequest.prototype.handleResponse = function (response) {
        var responseResult;
        var responseError;
        try {
            var unwrappedResponse = this._unwrapResponse(response);
            var responseObject = null;
            if (unwrappedResponse) {
                if (unwrappedResponse instanceof kaltura_api_exception_1.KalturaAPIException) {
                    // handle situation when multi request propagated actual api exception object.
                    responseObject = unwrappedResponse;
                }
                else if (unwrappedResponse.objectType === 'KalturaAPIException') {
                    responseObject = new kaltura_api_exception_1.KalturaAPIException(unwrappedResponse.message, unwrappedResponse.code, unwrappedResponse.args);
                }
                else {
                    responseObject = _super.prototype._parseResponseProperty.call(this, "", {
                        type: this.responseType,
                        subType: this.responseSubType
                    }, unwrappedResponse);
                }
            }
            if (!responseObject && this.responseType !== 'v') {
                responseError = new kaltura_api_exception_1.KalturaAPIException("server response is undefined, expected '".concat(this.responseType, " / ").concat(this.responseSubType, "'"), 'client::response_type_error', null);
            }
            else if (responseObject instanceof kaltura_api_exception_1.KalturaAPIException) {
                // got exception from library
                responseError = responseObject;
            }
            else {
                responseResult = responseObject;
            }
        }
        catch (ex) {
            responseError = new kaltura_api_exception_1.KalturaAPIException(ex.message, 'client::general_error', null);
        }
        var result = new kaltura_response_1.KalturaResponse(responseResult, responseError);
        if (this.callback) {
            try {
                this.callback(result);
            }
            catch (ex) {
                // do nothing by design
            }
        }
        return result;
    };
    KalturaRequest.prototype.setRequestOptions = function (arg) {
        this.__requestOptions__ = arg instanceof kaltura_request_options_1.KalturaRequestOptions ? arg : new kaltura_request_options_1.KalturaRequestOptions(arg);
        return this;
    };
    KalturaRequest.prototype.getRequestOptions = function () {
        return this.__requestOptions__;
    };
    KalturaRequest.prototype.buildRequest = function (defaultRequestOptions) {
        var requestOptionsObject = this.__requestOptions__ ? this.__requestOptions__.toRequestObject() : {};
        var defaultRequestOptionsObject = defaultRequestOptions ? defaultRequestOptions.toRequestObject() : {};
        return Object.assign({}, defaultRequestOptionsObject, requestOptionsObject, this.toRequestObject());
    };
    return KalturaRequest;
}(kaltura_request_base_1.KalturaRequestBase));
exports.KalturaRequest = KalturaRequest;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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LHFCQUFDO0FBQUQsQ0FsSEEsQUFrSEMsQ0FsSCtDLHlDQUFrQixHQWtIakU7QUFsSHFCLHdDQUFjIiwiZmlsZSI6ImFwaS9rYWx0dXJhLXJlcXVlc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBLYWx0dXJhUmVzcG9uc2UgfSBmcm9tIFwiLi9rYWx0dXJhLXJlc3BvbnNlXCI7XG5pbXBvcnQgeyBLYWx0dXJhUmVxdWVzdEJhc2UsIEthbHR1cmFSZXF1ZXN0QmFzZUFyZ3MgfSBmcm9tIFwiLi9rYWx0dXJhLXJlcXVlc3QtYmFzZVwiO1xuaW1wb3J0IHsgS2FsdHVyYUFQSUV4Y2VwdGlvbiB9IGZyb20gJy4va2FsdHVyYS1hcGktZXhjZXB0aW9uJztcbmltcG9ydCB7IEthbHR1cmFPYmplY3RCYXNlIH0gZnJvbSAnLi9rYWx0dXJhLW9iamVjdC1iYXNlJztcbmltcG9ydCB7IEthbHR1cmFSZXF1ZXN0T3B0aW9ucywgS2FsdHVyYVJlcXVlc3RPcHRpb25zQXJncyB9IGZyb20gJy4va2FsdHVyYS1yZXF1ZXN0LW9wdGlvbnMnO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2FsdHVyYVJlcXVlc3RBcmdzIGV4dGVuZHMgS2FsdHVyYVJlcXVlc3RCYXNlQXJncyB7IH1cblxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgS2FsdHVyYVJlcXVlc3Q8VD4gZXh0ZW5kcyBLYWx0dXJhUmVxdWVzdEJhc2Uge1xuXG4gIHByaXZhdGUgX19yZXF1ZXN0T3B0aW9uc19fOiBLYWx0dXJhUmVxdWVzdE9wdGlvbnM7XG4gIHByb3RlY3RlZCBjYWxsYmFjazogKHJlc3BvbnNlOiBLYWx0dXJhUmVzcG9uc2U8VD4pID0+IHZvaWQ7XG4gIHByaXZhdGUgcmVzcG9uc2VUeXBlOiBzdHJpbmc7XG4gIHByaXZhdGUgcmVzcG9uc2VTdWJUeXBlOiBzdHJpbmc7XG4gIHByb3RlY3RlZCBfcmVzcG9uc2VDb25zdHJ1Y3RvcjogeyBuZXcoKTogS2FsdHVyYU9iamVjdEJhc2UgfTsgLy8gTk9USUNFOiB0aGlzIHByb3BlcnR5IGlzIG5vdCB1c2VkIGRpcmVjdGx5LiBJdCBpcyBoZXJlIHRvIGZvcmNlIGltcG9ydCBvZiB0aGF0IHR5cGUgZm9yIGJ1bmRsaW5nIGlzc3Vlcy5cblxuICBjb25zdHJ1Y3RvcihkYXRhOiBLYWx0dXJhUmVxdWVzdEJhc2VBcmdzLCB7IHJlc3BvbnNlVHlwZSwgcmVzcG9uc2VTdWJUeXBlLCByZXNwb25zZUNvbnN0cnVjdG9yIH06IHsgcmVzcG9uc2VUeXBlOiBzdHJpbmcsIHJlc3BvbnNlU3ViVHlwZT86IHN0cmluZywgcmVzcG9uc2VDb25zdHJ1Y3RvcjogeyBuZXcoKTogS2FsdHVyYU9iamVjdEJhc2UgfSB9KSB7XG4gICAgc3VwZXIoZGF0YSk7XG4gICAgdGhpcy5yZXNwb25zZVN1YlR5cGUgPSByZXNwb25zZVN1YlR5cGU7XG4gICAgdGhpcy5yZXNwb25zZVR5cGUgPSByZXNwb25zZVR5cGU7XG4gICAgdGhpcy5fcmVzcG9uc2VDb25zdHJ1Y3RvciA9IHJlc3BvbnNlQ29uc3RydWN0b3I7XG4gIH1cblxuICBzZXRDb21wbGV0aW9uKGNhbGxiYWNrOiAocmVzcG9uc2U6IEthbHR1cmFSZXNwb25zZTxUPikgPT4gdm9pZCk6IHRoaXMge1xuICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHByaXZhdGUgX3Vud3JhcFJlc3BvbnNlKHJlc3BvbnNlOiBhbnkpOiBhbnkge1xuICAgIGlmIChlbnZpcm9ubWVudC5yZXNwb25zZS5uZXN0ZWRSZXNwb25zZSkge1xuICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdyZXN1bHQnKSkge1xuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0Lmhhc093blByb3BlcnR5KCdlcnJvcicpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnJlc3VsdC5lcnJvcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdlcnJvcicpKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5lcnJvcjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICBoYW5kbGVSZXNwb25zZShyZXNwb25zZTogYW55KTogS2FsdHVyYVJlc3BvbnNlPFQ+IHtcbiAgICBsZXQgcmVzcG9uc2VSZXN1bHQ6IGFueTtcbiAgICBsZXQgcmVzcG9uc2VFcnJvcjogYW55O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVud3JhcHBlZFJlc3BvbnNlID0gdGhpcy5fdW53cmFwUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgbGV0IHJlc3BvbnNlT2JqZWN0ID0gbnVsbDtcblxuICAgICAgaWYgKHVud3JhcHBlZFJlc3BvbnNlKSB7XG4gICAgICAgIGlmICh1bndyYXBwZWRSZXNwb25zZSBpbnN0YW5jZW9mIEthbHR1cmFBUElFeGNlcHRpb24pIHtcbiAgICAgICAgICAvLyBoYW5kbGUgc2l0dWF0aW9uIHdoZW4gbXVsdGkgcmVxdWVzdCBwcm9wYWdhdGVkIGFjdHVhbCBhcGkgZXhjZXB0aW9uIG9iamVjdC5cbiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IHVud3JhcHBlZFJlc3BvbnNlO1xuICAgICAgICB9IGVsc2UgaWYgKHVud3JhcHBlZFJlc3BvbnNlLm9iamVjdFR5cGUgPT09ICdLYWx0dXJhQVBJRXhjZXB0aW9uJykge1xuICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gbmV3IEthbHR1cmFBUElFeGNlcHRpb24oXG4gICAgICAgICAgICB1bndyYXBwZWRSZXNwb25zZS5tZXNzYWdlLFxuICAgICAgICAgICAgdW53cmFwcGVkUmVzcG9uc2UuY29kZSxcbiAgICAgICAgICAgIHVud3JhcHBlZFJlc3BvbnNlLmFyZ3NcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gc3VwZXIuX3BhcnNlUmVzcG9uc2VQcm9wZXJ0eShcbiAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGU6IHRoaXMucmVzcG9uc2VUeXBlLFxuICAgICAgICAgICAgICBzdWJUeXBlOiB0aGlzLnJlc3BvbnNlU3ViVHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVud3JhcHBlZFJlc3BvbnNlXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXJlc3BvbnNlT2JqZWN0ICYmIHRoaXMucmVzcG9uc2VUeXBlICE9PSAndicpIHtcbiAgICAgICAgcmVzcG9uc2VFcnJvciA9IG5ldyBLYWx0dXJhQVBJRXhjZXB0aW9uKGBzZXJ2ZXIgcmVzcG9uc2UgaXMgdW5kZWZpbmVkLCBleHBlY3RlZCAnJHt0aGlzLnJlc3BvbnNlVHlwZX0gLyAke3RoaXMucmVzcG9uc2VTdWJUeXBlfSdgLCAnY2xpZW50OjpyZXNwb25zZV90eXBlX2Vycm9yJywgbnVsbCk7XG4gICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlT2JqZWN0IGluc3RhbmNlb2YgS2FsdHVyYUFQSUV4Y2VwdGlvbikge1xuICAgICAgICAvLyBnb3QgZXhjZXB0aW9uIGZyb20gbGlicmFyeVxuICAgICAgICByZXNwb25zZUVycm9yID0gcmVzcG9uc2VPYmplY3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNwb25zZVJlc3VsdCA9IHJlc3BvbnNlT2JqZWN0O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICByZXNwb25zZUVycm9yID0gbmV3IEthbHR1cmFBUElFeGNlcHRpb24oZXgubWVzc2FnZSwgJ2NsaWVudDo6Z2VuZXJhbF9lcnJvcicsIG51bGwpO1xuICAgIH1cblxuXG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IEthbHR1cmFSZXNwb25zZTxUPihyZXNwb25zZVJlc3VsdCwgcmVzcG9uc2VFcnJvcik7XG5cbiAgICBpZiAodGhpcy5jYWxsYmFjaykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5jYWxsYmFjayhyZXN1bHQpO1xuICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgLy8gZG8gbm90aGluZyBieSBkZXNpZ25cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgc2V0UmVxdWVzdE9wdGlvbnMob3B0aW9uQXJnczogS2FsdHVyYVJlcXVlc3RPcHRpb25zQXJncyk6IHRoaXM7XG4gIHNldFJlcXVlc3RPcHRpb25zKG9wdGlvbnM6IEthbHR1cmFSZXF1ZXN0T3B0aW9ucyk6IHRoaXM7XG4gIHNldFJlcXVlc3RPcHRpb25zKGFyZzogS2FsdHVyYVJlcXVlc3RPcHRpb25zQXJncyB8IEthbHR1cmFSZXF1ZXN0T3B0aW9ucyk6IHRoaXMge1xuICAgIHRoaXMuX19yZXF1ZXN0T3B0aW9uc19fID0gYXJnIGluc3RhbmNlb2YgS2FsdHVyYVJlcXVlc3RPcHRpb25zID8gYXJnIDogbmV3IEthbHR1cmFSZXF1ZXN0T3B0aW9ucyhhcmcpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0UmVxdWVzdE9wdGlvbnMoKTogS2FsdHVyYVJlcXVlc3RPcHRpb25zIHtcbiAgICByZXR1cm4gdGhpcy5fX3JlcXVlc3RPcHRpb25zX187XG4gIH1cblxuICBidWlsZFJlcXVlc3QoZGVmYXVsdFJlcXVlc3RPcHRpb25zOiBLYWx0dXJhUmVxdWVzdE9wdGlvbnMpOiB7fSB7XG4gICAgY29uc3QgcmVxdWVzdE9wdGlvbnNPYmplY3QgPSB0aGlzLl9fcmVxdWVzdE9wdGlvbnNfXyA/IHRoaXMuX19yZXF1ZXN0T3B0aW9uc19fLnRvUmVxdWVzdE9iamVjdCgpIDoge307XG4gICAgY29uc3QgZGVmYXVsdFJlcXVlc3RPcHRpb25zT2JqZWN0ID0gZGVmYXVsdFJlcXVlc3RPcHRpb25zID8gZGVmYXVsdFJlcXVlc3RPcHRpb25zLnRvUmVxdWVzdE9iamVjdCgpIDoge307XG5cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihcbiAgICAgIHt9LFxuICAgICAgZGVmYXVsdFJlcXVlc3RPcHRpb25zT2JqZWN0LFxuICAgICAgcmVxdWVzdE9wdGlvbnNPYmplY3QsXG4gICAgICB0aGlzLnRvUmVxdWVzdE9iamVjdCgpXG4gICAgKTtcbiAgfVxufVxuIl19
